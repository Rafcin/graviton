<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>main.s</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl ppc">.data</span>
    prompt<span class="hl opt">:</span> <span class="hl ppc">.asciz</span> <span class="hl pps">&quot;Enter a string or value - &quot;</span><span class="hl ppc"></span>
    entered<span class="hl opt">:</span> <span class="hl ppc">.asciz</span> <span class="hl pps">&quot;You entered - &quot;</span><span class="hl ppc"></span>
    nl<span class="hl opt">:</span>  <span class="hl ppc">.asciz</span> <span class="hl pps">&quot;</span><span class="hl esc">\n</span><span class="hl pps">&quot;</span><span class="hl ppc"></span>
    
<span class="hl ppc">.text</span>
<span class="hl ppc">.global main</span>
    main<span class="hl opt">:</span>
        <span class="hl opt">//</span> Print the prompt
        ldr x0<span class="hl opt">, =</span>prompt
        <span class="hl kwa">bl</span>  putstr
        
        <span class="hl opt">//</span> Call the `inprdr` subroutine
        <span class="hl kwa">bl</span>  inprdr
        
        <span class="hl opt">//</span> Save the pointer to the input buffer
        str x0<span class="hl opt">, [</span>sp<span class="hl opt">,</span> <span class="hl slc">#-16]!</span>
        
        <span class="hl opt">//</span> Print the entered text
        ldr x0<span class="hl opt">, =</span>entered
        <span class="hl kwa">bl</span>  putstr

        <span class="hl opt">//</span> Print the user<span class="hl str">&apos;s input</span>
<span class="hl str">        ldr x0, [sp]   // Load the pointer without modifying the stack pointer</span>
<span class="hl str">        bl  putstr</span>
<span class="hl str"></span>
<span class="hl str">        // Load the pointer and readjust the stack pointer</span>
<span class="hl str">        ldr x0, [sp], #16</span>
<span class="hl str">        </span>
<span class="hl str">        // Call `free` subroutine to free the allocated memory</span>
<span class="hl str">        bl free</span>
<span class="hl str">        </span>
<span class="hl str">        // Print newline</span>
<span class="hl str">        ldr x0, =nl</span>
<span class="hl str">        bl  putstr</span>
<span class="hl str">        </span>
<span class="hl str">        // Setup the parameters to exit the program and then call Linux to do it.</span>
<span class="hl str">        mov x0, #0  // Sets return code to 0</span>
<span class="hl str">        mov x8, #93 // Service command code 93 terminates</span>
<span class="hl str">        svc 0       // Call linux to terminate the program</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.41, http://www.andre-simon.de/-->
