<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>tolwr.s</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl com">/**</span>
<span class="hl com"> * tolwr.s</span>
<span class="hl com"> * PARAMETERS: X0 (INPUT STRING OF SIZE N)</span>
<span class="hl com"> * OUTPUT    : X0 (STRING, CONVERTED)</span>
<span class="hl com"> * The purpose of this function is to convert all uppercase letters</span>
<span class="hl com"> * to lowercase.</span>
<span class="hl com"> * ALL REGISTERS PRESERVED EXCEPT X0</span>
<span class="hl com"> */</span>

<span class="hl ppc">.text</span>
<span class="hl ppc">.global tolwr</span>
    tolwr<span class="hl opt">:</span>
        stp x19<span class="hl opt">,</span>x20<span class="hl opt">, [</span>sp<span class="hl opt">, -</span><span class="hl num">16</span><span class="hl opt">]! //</span> pushing x19 <span class="hl kwa">and</span> x20 to stack pointer
        mov x19<span class="hl opt">,</span> <span class="hl slc">#-1            // setting increment</span>
        <span class="hl kwa">b</span>   toLwrLoop           <span class="hl opt">//</span> branch to <span class="hl str">&apos;toLwrLoop&apos;</span>
    toLwrConvert<span class="hl opt">:</span>
        <span class="hl kwa">add</span> w20<span class="hl opt">,</span> w20<span class="hl opt">,</span> <span class="hl slc">#32       // converts the char from uppercase to lowercase</span>
        strb w20<span class="hl opt">, [</span>x0<span class="hl opt">,</span> x19<span class="hl opt">]     //</span> storing byte in w0 string
    toLwrLoop<span class="hl opt">:</span>
        <span class="hl kwa">add</span>  x19<span class="hl opt">,</span> x19<span class="hl opt">,</span> <span class="hl slc">#1       // x19++</span>
        ldrb w20<span class="hl opt">, [</span>x0<span class="hl opt">,</span> x19<span class="hl opt">]     //</span> load byte from str <span class="hl kwa">and</span> post increment
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#0            // compare loaded byte and null</span>
        b.eq toLwrEnd           <span class="hl opt">//</span> if null<span class="hl opt">,</span> goto <span class="hl str">&apos;toLwrEnd&apos;</span>
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#&apos;A&apos;          // if char is less than &apos;Z&apos;...</span>
        b.lt toLwrLoop          <span class="hl opt">//</span> then return to toLwrLoop
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#&apos;Z&apos;          // else, if w20 is less than &apos;Z&apos;</span>
        b.le toLwrConvert       <span class="hl opt">//</span> you<span class="hl str">&apos;re lowercase, so go to the convert label</span>
<span class="hl str">        b    toLwrLoop          // go back to lwr :)</span>
<span class="hl str">    toLwrEnd:</span>
<span class="hl str">        ldp x19, x20, [sp], 16  // popping x19 and x20 from stack</span>
<span class="hl str">        ret lr                  // return to caller</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 3.41, http://www.andre-simon.de/-->
