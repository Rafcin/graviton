<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>strtwthpos.s</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl com">/**</span>
<span class="hl com"> * strtwthpos - Returns true if the String begins with str, starting from the specified index &quot;fromIndex&quot;.</span>
<span class="hl com"> *</span>
<span class="hl com"> * &#64;param x0: Address of the main string to check.</span>
<span class="hl com"> * &#64;param x1: Address of the substring to check.</span>
<span class="hl com"> * &#64;param x2: Starting index in the main string.</span>
<span class="hl com"> * &#64;return x0: 1 if the main string begins with the substring from the specified index, 0 otherwise.</span>
<span class="hl com"> * Registers used: x0, x1, x2, x3, x4, x5</span>
<span class="hl com"> * Registers saved: none</span>
<span class="hl com"> */</span>
<span class="hl ppc">.text</span>
<span class="hl ppc">.global strtwthpos</span>
    strtwthpos<span class="hl opt">:</span>
        str x0<span class="hl opt">, [</span>sp<span class="hl opt">,</span> <span class="hl slc">#-16]!</span>
        str x2<span class="hl opt">, [</span>sp<span class="hl opt">,</span> <span class="hl slc">#-16]!</span>
        mov x3<span class="hl opt">,</span> <span class="hl slc">#0 // Initialize x3 to 0</span>
        loop<span class="hl opt">:</span>
            ldrb w4<span class="hl opt">, [</span>x0<span class="hl opt">,</span> x2<span class="hl opt">] //</span> Load byte from main string
            ldrb w5<span class="hl opt">, [</span>x1<span class="hl opt">,</span> x3<span class="hl opt">] //</span> Load byte from substring
            <span class="hl kwa">cmp</span> w5<span class="hl opt">,</span> <span class="hl slc">#0 // If the substring byte is null, return true</span>
            <span class="hl kwa">beq</span> end_of_substring
            <span class="hl kwa">cmp</span> w4<span class="hl opt">,</span> w5
            b.ne not_equal
            <span class="hl kwa">add</span> x3<span class="hl opt">,</span> x3<span class="hl opt">,</span> <span class="hl slc">#1 // Increment substring index</span>
            <span class="hl kwa">add</span> x2<span class="hl opt">,</span> x2<span class="hl opt">,</span> <span class="hl slc">#1 // Increment main string index</span>
            <span class="hl kwa">b</span> loop
        not_equal<span class="hl opt">:</span>
            mov x0<span class="hl opt">,</span> <span class="hl slc">#0 // Return 0 (false)</span>
            <span class="hl kwa">b</span> end
        end_of_substring<span class="hl opt">:</span>
            mov x0<span class="hl opt">,</span> <span class="hl slc">#1 // Return 1 (true)</span>
        end<span class="hl opt">:</span>
            ldr x2<span class="hl opt">, [</span>sp<span class="hl opt">],</span> <span class="hl slc">#16</span>
            ldr x0<span class="hl opt">, [</span>sp<span class="hl opt">],</span> <span class="hl slc">#16</span>
            ret
</pre>
</body>
</html>
<!--HTML generated by highlight 3.41, http://www.andre-simon.de/-->
