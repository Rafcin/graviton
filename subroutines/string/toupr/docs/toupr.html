<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>toupr.s</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl com">/**</span>
<span class="hl com"> * toupr.s</span>
<span class="hl com"> * PARAMETERS: X0 (INPUT STRING OF SIZE N)</span>
<span class="hl com"> * OUTPUT    : X0 (STRING, CONVERTED)</span>
<span class="hl com"> * The purpose of this function is to convert all lowercase letters</span>
<span class="hl com"> * to uppercase.</span>
<span class="hl com"> * ALL REGISTERS PRESERVED EXCEPT X0</span>
<span class="hl com"> */</span>

<span class="hl ppc">.text</span>
<span class="hl ppc">.global toupr</span>
    toupr<span class="hl opt">:</span>
        stp x19<span class="hl opt">,</span>x20<span class="hl opt">, [</span>sp<span class="hl opt">, -</span><span class="hl num">16</span><span class="hl opt">]! //</span> pushing x19 <span class="hl kwa">and</span> x20 to stack pointer
        mov x19<span class="hl opt">,</span> <span class="hl slc">#-1            // setting increment</span>
        <span class="hl kwa">b</span>   toUprLoop           <span class="hl opt">//</span> branch to <span class="hl str">&apos;toUprLoop&apos;</span>
    toUprConvert<span class="hl opt">:</span>
        <span class="hl kwa">sub</span> w20<span class="hl opt">,</span> w20<span class="hl opt">,</span> <span class="hl slc">#32       // converts the char from lowercase to uppercase</span>
        strb w20<span class="hl opt">, [</span>x0<span class="hl opt">,</span> x19<span class="hl opt">]     //</span> storing byte in w0 string
    toUprLoop<span class="hl opt">:</span>
        <span class="hl kwa">add</span>  x19<span class="hl opt">,</span> x19<span class="hl opt">,</span> <span class="hl slc">#1       // x19++</span>
        ldrb w20<span class="hl opt">, [</span>x0<span class="hl opt">,</span> x19<span class="hl opt">]     //</span> load byte from str <span class="hl kwa">and</span> post increment
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#0            // compare loaded byte and null</span>
        b.eq toUprEnd           <span class="hl opt">//</span> if null<span class="hl opt">,</span> goto <span class="hl str">&apos;toUprEnd&apos;</span>
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#&apos;a&apos;          // if char is less than &apos;a&apos;...</span>
        b.lt toUprLoop          <span class="hl opt">//</span> then return to toUprLoop
        <span class="hl kwa">cmp</span>  w20<span class="hl opt">,</span> <span class="hl slc">#&apos;z&apos;          // else, if w20 is less than &apos;z&apos;</span>
        b.le toUprConvert       <span class="hl opt">//</span> you<span class="hl str">&apos;re lowercase, so go to the convert label</span>
<span class="hl str">        b    toUprLoop          // you&apos;</span>re one of the few weird chars<span class="hl opt">,</span> go back to upr <span class="hl opt">:)</span>
    toUprEnd<span class="hl opt">:</span>
        ldp x19<span class="hl opt">,</span> x20<span class="hl opt">, [</span>sp<span class="hl opt">],</span> <span class="hl num">16</span>  <span class="hl opt">//</span> popping x19 <span class="hl kwa">and</span> x20 from stack
        ret <span class="hl kwb">lr</span>                  <span class="hl opt">//</span> return to caller
</pre>
</body>
</html>
<!--HTML generated by highlight 3.41, http://www.andre-simon.de/-->
